---
title: "Plots"
author: "Jimmy, A. Warren"
date: "2020/12/3"
output: html_document
---
```{r load-packages}
library(tidyverse)
library(tidymodels)
```

```{r load-data}
teams_cleaned <- read_csv("/cloud/project/data/teams-cleaned.csv")

set.seed(3)
teams_split <- initial_split(teams_cleaned, prop = 0.80)
teams_train <- training(teams_split)
teams_test <- testing(teams_split)
```


```{r isolated-power}
#Had to make a bunch of adjustments to Jimmy's plots and add some more stuff for
#analysis purposes. It's the same process for every variable, so I'll just walk
#through the first one.

#create graph, add linear model trendline
teams_train %>%
  ggplot(mapping = aes(x = mean_iso , y = win_rate)) +
  geom_point(size = 1.2, alpha = 0.35) +
  geom_smooth(method = "lm")

#linear model, note R squared and adjusted R squared
iso_fit <- linear_reg() %>%
  set_engine("lm") %>%
  fit(win_rate ~ mean_iso, data = teams_train)
tidy(iso_fit)
glance(iso_fit)

#residuals analysis
iso_aug <- augment(iso_fit$fit)
ggplot(data = iso_aug,
       aes(x = .fitted,
           y = .resid)) +
  geom_jitter() +
  geom_hline(yintercept = 0,
             linetype = "dashed")
```
